<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Architecture | Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0A0E27;
            color: #E8EAED;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: #161B33;
            padding: 24px 32px;
            border-bottom: 1px solid #252A41;
            margin-bottom: 24px;
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 4px;
        }

        .subtitle {
            color: #9AA0A6;
            font-size: 14px;
        }

        nav {
            background: #161B33;
            padding: 12px 32px;
            border-bottom: 1px solid #252A41;
            margin-bottom: 24px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        nav a {
            padding: 8px 16px;
            text-decoration: none;
            color: #9AA0A6;
            font-weight: 500;
            font-size: 14px;
            border-radius: 6px;
            transition: all 0.2s;
        }

        nav a:hover {
            background: #1F2544;
            color: #FFFFFF;
        }

        nav a.active {
            background: #1A73E8;
            color: #FFFFFF;
        }

        .content {
            background: #161B33;
            border: 1px solid #252A41;
            border-radius: 8px;
            padding: 40px;
        }

        h2 {
            color: #FFFFFF;
            font-size: 20px;
            font-weight: 600;
            margin: 32px 0 16px 0;
            padding-top: 16px;
            border-top: 1px solid #252A41;
        }

        h2:first-child {
            margin-top: 0;
            padding-top: 0;
            border-top: none;
        }

        p {
            color: #BDC1C6;
            margin-bottom: 16px;
        }

        .architecture-flow {
            background: #1F2544;
            padding: 24px;
            border-radius: 6px;
            margin: 20px 0;
            border: 1px solid #252A41;
        }

        .flow-box {
            background: #161B33;
            border: 2px solid #1A73E8;
            border-radius: 6px;
            padding: 16px;
            margin: 12px 0;
            text-align: center;
        }

        .flow-box h3 {
            color: #FFFFFF;
            margin-bottom: 6px;
            font-size: 15px;
            font-weight: 600;
        }

        .flow-box p {
            color: #9AA0A6;
            font-size: 13px;
            margin: 0;
        }

        .flow-arrow {
            text-align: center;
            font-size: 24px;
            color: #1A73E8;
            margin: 8px 0;
        }

        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .component-card {
            background: #1F2544;
            border-left: 3px solid #1A73E8;
            padding: 16px;
            border-radius: 6px;
        }

        .component-card h3 {
            color: #FFFFFF;
            margin-bottom: 8px;
            font-size: 15px;
            font-weight: 600;
        }

        .component-card code {
            background: #0A0E27;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #1A73E8;
        }

        .component-card p {
            font-size: 14px;
            color: #9AA0A6;
            margin: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #252A41;
        }

        th {
            background: #1F2544;
            color: #9AA0A6;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            color: #BDC1C6;
        }

        tr:hover {
            background: #1F2544;
        }

        ul {
            margin: 12px 0 12px 24px;
            color: #BDC1C6;
        }

        li {
            margin: 8px 0;
        }

        pre {
            background: #0A0E27;
            color: #E8EAED;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.5;
        }

        .tech-stack {
            background: #1F2544;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }

        .tech-stack h3 {
            color: #FFFFFF;
            margin-bottom: 12px;
            font-size: 15px;
            font-weight: 600;
        }

        .tech-badge {
            display: inline-block;
            background: #161B33;
            border: 1px solid #1A73E8;
            color: #1A73E8;
            padding: 6px 12px;
            border-radius: 4px;
            margin: 4px;
            font-weight: 500;
            font-size: 13px;
        }

        @media (max-width: 768px) {
            h1 { font-size: 20px; }
            .content { padding: 24px; }
            .component-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>System Architecture</h1>
            <p class="subtitle">Trading infrastructure</p>
        </header>

        <nav>
            <a href="index.html">Dashboard</a>
            <a href="about.html">Strategy</a>
            <a href="research.html">Research</a>
            <a href="system.html" class="active">System</a>
            <a href="theory.html">Models</a>
        </nav>

        <div class="content">
            <h2>Architecture</h2>

            <div class="architecture-flow">
                <div class="flow-box">
                    <h3>Signal Generation</h3>
                    <p>Mean reversion, volatility alerts, whale tracking</p>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-box">
                    <h3>Risk Management</h3>
                    <p>Position limits, exposure caps, spread checks</p>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-box">
                    <h3>Position Sizing</h3>
                    <p>Kelly Criterion for optimal bet sizing</p>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-box">
                    <h3>Execution</h3>
                    <p>Polymarket Agents integration</p>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-box">
                    <h3>Monitoring</h3>
                    <p>Dashboard, database, logs</p>
                </div>
            </div>

            <h2>Core Components</h2>

            <div class="component-grid">
                <div class="component-card">
                    <h3>Orchestrator</h3>
                    <p><code>orchestrator.py</code></p>
                    <p>Main trading loop coordinator. Fetches signals, applies risk checks, sizes positions, and executes trades.</p>
                </div>

                <div class="component-card">
                    <h3>Signal Generator</h3>
                    <p><code>mean_reversion/generator.py</code></p>
                    <p>Analyzes market data for mean reversion opportunities using z-scores and historical volatility.</p>
                </div>

                <div class="component-card">
                    <h3>Risk Manager</h3>
                    <p><code>risk_manager.py</code></p>
                    <p>Enforces position limits, total exposure caps, spread checks, and drawdown monitoring.</p>
                </div>

                <div class="component-card">
                    <h3>Position Sizer</h3>
                    <p><code>position_sizer.py</code></p>
                    <p>Implements Kelly Criterion with configurable fractions to determine optimal trade size.</p>
                </div>

                <div class="component-card">
                    <h3>Executor</h3>
                    <p><code>executor.py</code></p>
                    <p>Bridge to Polymarket Agents framework. Handles order construction, wallet signing, and trade submission.</p>
                </div>

                <div class="component-card">
                    <h3>Paper Trader</h3>
                    <p><code>paper_trader.py</code></p>
                    <p>Simulates trades without real money. Tracks P&L and validates strategy.</p>
                </div>

                <div class="component-card">
                    <h3>Data Recorder</h3>
                    <p><code>data_recorder.py</code></p>
                    <p>Captures live market data for future backtesting and strategy improvement.</p>
                </div>

                <div class="component-card">
                    <h3>Trade Logger</h3>
                    <p><code>trade_logger.py</code></p>
                    <p>Writes trade history to SQLite database and JSON logs. Provides audit trail.</p>
                </div>

                <div class="component-card">
                    <h3>Polymarket Client</h3>
                    <p><code>polymarket_data/client.py</code></p>
                    <p>API wrapper for fetching markets, orderbooks, and price history from Polymarket.</p>
                </div>
            </div>

            <h2>Model Configuration</h2>

            <table>
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>Min Signal</th>
                        <th>Max Position</th>
                        <th>Kelly Fraction</th>
                        <th>Check Interval</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Conservative</strong></td>
                        <td>STRONG</td>
                        <td>$200</td>
                        <td>0.15</td>
                        <td>10 min</td>
                    </tr>
                    <tr>
                        <td><strong>Moderate</strong></td>
                        <td>MODERATE</td>
                        <td>$500</td>
                        <td>0.25</td>
                        <td>5 min</td>
                    </tr>
                    <tr>
                        <td><strong>Aggressive</strong></td>
                        <td>WEAK</td>
                        <td>$800</td>
                        <td>0.35</td>
                        <td>3 min</td>
                    </tr>
                </tbody>
            </table>

            <p>Each model runs as a separate Docker container with its own database, config, and logs. They operate independently.</p>

            <h2>Data Flow</h2>

            <p><strong>Input:</strong> Polymarket API → Market data, orderbooks, price history</p>
            <p><strong>Processing:</strong> Signal generation → Risk checks → Position sizing</p>
            <p><strong>Execution:</strong> Paper trader (simulation) or Live executor (real trades)</p>
            <p><strong>Storage:</strong> SQLite (structured) + JSON (raw logs) + CSV (market snapshots)</p>
            <p><strong>Output:</strong> Dashboard API → Vercel frontend → Browser</p>

            <h2>Technology Stack</h2>

            <div class="tech-stack">
                <h3>Infrastructure</h3>
                <span class="tech-badge">Docker</span>
                <span class="tech-badge">Docker Compose</span>
                <span class="tech-badge">Cloudflare Tunnel</span>
                <span class="tech-badge">Vercel</span>
            </div>

            <div class="tech-stack">
                <h3>Backend</h3>
                <span class="tech-badge">Python</span>
                <span class="tech-badge">FastAPI</span>
                <span class="tech-badge">SQLite</span>
                <span class="tech-badge">httpx</span>
                <span class="tech-badge">pydantic</span>
            </div>

            <div class="tech-stack">
                <h3>Frontend</h3>
                <span class="tech-badge">HTML5</span>
                <span class="tech-badge">CSS3</span>
                <span class="tech-badge">JavaScript</span>
                <span class="tech-badge">Fetch API</span>
            </div>

            <div class="tech-stack">
                <h3>Blockchain</h3>
                <span class="tech-badge">Polygon</span>
                <span class="tech-badge">USDC</span>
                <span class="tech-badge">Polymarket Agents</span>
            </div>

            <h2>Project Structure</h2>

            <pre>toolkit/
├── execution-engine/       Core trading infrastructure
│   ├── orchestrator.py     Main coordinator
│   ├── executor.py         Trade execution
│   ├── risk_manager.py     Risk controls
│   ├── position_sizer.py   Kelly Criterion
│   ├── paper_trader.py     Simulation mode
│   └── data_recorder.py    Live data capture
│
├── mean-reversion/         Signal generation
├── volatility-alerts/      Price spike detection
├── whale-tracker/          Smart money monitoring
└── polymarket-data/        API client

agents/
└── systematic_trader.py    Main trading bot

api/
└── dashboard_api.py        FastAPI backend

config/
├── active_conservative.yaml
├── active_moderate.yaml
└── active_aggressive.yaml

data/
├── trades_conservative.db
├── trades_moderate.db
├── trades_aggressive.db
└── recordings_{model}/     Live market data

vercel-frontend/
└── public/                 Dashboard pages

docker-compose.yml          Multi-container orchestration</pre>

            <h2>Trading Loop</h2>

            <ol>
                <li>Wake up (every 3-10 minutes depending on model)</li>
                <li>Fetch markets from Polymarket API</li>
                <li>Generate signals for each market</li>
                <li>Filter signals by strength threshold</li>
                <li>Check risk (position limits, total exposure, spread)</li>
                <li>Size position using Kelly Criterion</li>
                <li>Execute trade (paper: simulate, live: sign and submit)</li>
                <li>Log everything (database + JSON + CSV)</li>
                <li>Record market data for future analysis</li>
                <li>Sleep until next cycle</li>
            </ol>

            <h2>Safety Features</h2>

            <ul>
                <li>Position limits: $200-800 per trade depending on model</li>
                <li>Total exposure cap: $2,000 across all positions</li>
                <li>Max positions: 10 open positions at once</li>
                <li>Spread checks: Reject trades with spread above 5%</li>
                <li>Drawdown monitoring: Emergency stop at 25% drawdown</li>
                <li>Slippage limits: Max 2% slippage per trade</li>
                <li>Paper trading mode: Validate before going live</li>
                <li>Emergency stop script: <code>scripts/emergency_stop.py</code></li>
            </ul>

            <h2>Monitoring</h2>

            <div class="component-grid">
                <div class="component-card">
                    <h3>Live Dashboard</h3>
                    <p>Real-time P&L, win rates, trade counts for all 3 models. Auto-refreshes every 10 seconds.</p>
                </div>

                <div class="component-card">
                    <h3>SQLite Database</h3>
                    <p>Structured trade history with timestamps, prices, P&L, and metadata.</p>
                </div>

                <div class="component-card">
                    <h3>JSON Logs</h3>
                    <p>Detailed logs of every decision: signals generated, risk checks, execution results.</p>
                </div>

                <div class="component-card">
                    <h3>CSV Recordings</h3>
                    <p>Market data snapshots: best bid, best ask, spread, volume. Used for future backtesting.</p>
                </div>

                <div class="component-card">
                    <h3>Docker Logs</h3>
                    <p><code>docker compose logs [model]</code> for container-level debugging.</p>
                </div>

                <div class="component-card">
                    <h3>Health Checks</h3>
                    <p>Automated container health monitoring. Dashboard shows status.</p>
                </div>
            </div>

            <div style="margin-top: 32px; padding: 20px; background: #1F2544; border-radius: 6px;">
                <p style="margin-bottom: 12px;"><strong>Additional Resources:</strong></p>
                <ul style="margin-left: 20px;">
                    <li>See <a href="theory.html" style="color: #1A73E8; text-decoration: none;">Models</a> for mathematical foundations</li>
                    <li>View <a href="index.html" style="color: #1A73E8; text-decoration: none;">Dashboard</a> for live performance</li>
                    <li>Read <a href="research.html" style="color: #1A73E8; text-decoration: none;">Research</a> for academic sources</li>
                    <li>Check <a href="https://github.com/b1rdmania/aztec-auction-analysis" target="_blank" style="color: #1A73E8; text-decoration: none;">GitHub</a> for source code</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>
